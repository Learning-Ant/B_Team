<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.koreait.baraON.dao.PlaceDao">
	
	<select id="placeList" resultType="com.koreait.baraON.dto.PlaceListDto" >
		SELECT A.*, COUNT(*) AS RVCOUNT
		  FROM (SELECT P.P_NO, PC.PC_NAME, MIN(PO.PO_DAYPRICE) AS MINPRICE, MAX(PO.PO_MAX) AS MAXPEOPLE
				  FROM PLACE P LEFT JOIN PLACECATEGORY PC ON P.PC_NO = PC.PC_NO
							   LEFT JOIN PLACEOPTION PO ON P.P_NO = PO.P_NO
			  GROUP BY P.P_NO, PC.PC_NAME) A LEFT JOIN REVIEW R ON A.P_NO = R.P_NO
	  GROUP BY A.P_NO, A.PC_NAME, A.MINPRICE, A.MAXPEOPLE, R.P_NO
	  ORDER BY A.P_NO
	</select>
	
	
	
	
</mapper>