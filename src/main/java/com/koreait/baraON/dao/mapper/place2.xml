<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.koreait.baraON.dao.PlaceDao2">
	
	<select id="allPlaceSearch"  parameterType="com.koreait.baraON.dto.PlaceDto" resultType="com.koreait.baraON.dto.PlaceListDto">
		SELECT *
		FROM PLACE
		WHERE S_NO = #{s_no} AND P_DELETE = 0
	</select>
	
	<select id="placeCaSearch"  parameterType="com.koreait.baraON.dto.PlaceDto" resultType="com.koreait.baraON.dto.PlaceListDto">
		SELECT *
		FROM PLACE
		WHERE S_NO=#{s_no} AND PC_NO=#{pc_no} P_DELETE = 0
	</select>
	
	<select id="allPlaceSearch2"  parameterType="com.koreait.baraON.dto.PlaceDto" resultType="com.koreait.baraON.dto.PlaceListDto">
		SELECT *
		FROM PLACE
		WHERE S_NO = #{s_no} AND P_DELETE = 1
	</select>

	<select id="placeCaSearch2"  parameterType="com.koreait.baraON.dto.PlaceDto" resultType="com.koreait.baraON.dto.PlaceListDto">
		SELECT *
		FROM PLACE
		WHERE S_NO=#{s_no} AND PC_NO=#{pc_no} P_DELETE = 1
	</select>
	
	<select id="placeList" resultType="com.koreait.baraON.dto.ReviewCheckDto">
		SELECT B.*
			FROM (SELECT ROWNUM RN , A.P_TITLE, A.RV_CONTENT, A.RV_STAR, A.M_ID
				FROM (SELECT RV.*, P.*, M.*
					FROM REVIEW RV LEFT JOIN PLACE P ON RV.P_NO=P.P_NO
					LEFT JOIN MEMBER M ON RV.M_NO = M.M_NO
					WHERE P.P_DELETE = 0
					AND P.P_CONFIRM LIKE '승인'
					AND P.S_NO={param1}) A) B
			WHERE RN BETWEEN {param2} AND {param3}
	</select>
	
	<select id="placeCount" resultType="int">
		SELECT COUNT(*)
		FROM PLACE
	</select>
	
	
</mapper>